import router from '@ohos.router'

// Demo é¡¹ç›®ä¿¡æ¯æ¥å£
interface DemoItem {
  icon: string
  title: string
  description: string
  route: string
  color: string
}

// åˆ†ç±»æ¥å£
interface CategoryItem {
  name: string
  icon: string
  color: string
  demos: Array<DemoItem>
}

@Entry
@Component
struct Index {
  @State categories: Array<CategoryItem> = []
  @State expandedIndex: number = 0

  aboutToAppear() {
    this.categories = [
      {
        name: 'åŸºç¡€è¯­æ³•',
        icon: 'ğŸ“',
        color: '#007DFF',
        demos: [
          {
            icon: 'ğŸ¨',
            title: 'è£…é¥°å™¨å­¦ä¹ ',
            description: 'State/Prop/Link/Builder',
            route: 'pages/DecoratorDemo',
            color: '#007DFF'
          },
          {
            icon: 'ğŸ“',
            title: 'è¯­æ³•å­¦ä¹ ',
            description: 'ArkTS vs TS',
            route: 'pages/ArkTSSyntaxDemo',
            color: '#52C41A'
          }
        ]
      },
      {
        name: 'å¸ƒå±€ç»„ä»¶',
        icon: 'ğŸ“',
        color: '#52C41A',
        demos: [
          {
            icon: 'ğŸ“',
            title: 'å¸ƒå±€å­¦ä¹ ',
            description: 'Column/Row/Grid/Flex',
            route: 'pages/LayoutDemo',
            color: '#52C41A'
          }
        ]
      },
      {
        name: 'äº¤äº’ç»„ä»¶',
        icon: 'ğŸ‘†',
        color: '#FF6B6B',
        demos: [
          {
            icon: 'ğŸ”˜',
            title: 'æŒ‰é’®ä¸é€‰æ‹©',
            description: 'Button/Toggle/Checkboxç­‰',
            route: 'pages/ButtonAndSelectDemo',
            color: '#FF6B6B'
          },
          {
            icon: 'ğŸ§­',
            title: 'å¯¼èˆªä¸åˆ‡æ¢',
            description: 'Tabs/TabContent',
            route: 'pages/NavigationDemo',
            color: '#EB2F96'
          }
        ]
      },
      {
        name: 'å±•ç¤ºç»„ä»¶',
        icon: 'ğŸ–¼ï¸',
        color: '#FA541C',
        demos: [
          {
            icon: 'ğŸ–¼ï¸',
            title: 'å›¾ç‰‡ä¸è§†é¢‘',
            description: 'Image/Video',
            route: 'pages/MediaDemo',
            color: '#FA541C'
          },
          {
            icon: 'ğŸ“Š',
            title: 'ä¿¡æ¯å±•ç¤º',
            description: 'Progress/Dialog',
            route: 'pages/InfoDisplayDemo',
            color: '#13C2C2'
          },
          {
            icon: 'ğŸ‘†',
            title: 'æ‰‹åŠ¿ç»„ä»¶',
            description: 'Tap/Pan/Pinch',
            route: 'pages/GestureDemo',
            color: '#A020F0'
          },
          {
            icon: 'ğŸ¬',
            title: 'åŠ¨ç”»ç»„ä»¶',
            description: 'animateTo/transition',
            route: 'pages/AnimationDemo',
            color: '#F753AB'
          },
          {
            icon: 'ğŸ’¬',
            title: 'å¼¹çª—ç»„ä»¶',
            description: 'AlertDialog/Popup',
            route: 'pages/DialogDemo',
            color: '#FF4D4F'
          },
          {
            icon: 'ğŸ ',
            title: 'è½®æ’­ç»„ä»¶',
            description: 'Swiper',
            route: 'pages/SwiperDemo',
            color: '#FF6B6B'
          },
          {
            icon: 'ğŸ”„',
            title: 'ä¸‹æ‹‰åˆ·æ–°',
            description: 'Refresh',
            route: 'pages/RefreshDemo',
            color: '#13C2C2'
          },
          {
            icon: 'â³',
            title: 'åŠ è½½è¿›åº¦',
            description: 'LoadingProgress/Progress',
            route: 'pages/LoadingProgressDemo',
            color: '#9C27B0'
          },
          {
            icon: 'ğŸ“œ',
            title: 'æ»šåŠ¨å®¹å™¨',
            description: 'Scroll',
            route: 'pages/ScrollDemo',
            color: '#722ED1'
          },
          {
            icon: 'ğŸ§­',
            title: 'å¯¼èˆªç»„ä»¶',
            description: 'Navigator',
            route: 'pages/NavigatorDemo',
            color: '#FA541C'
          }
        ]
      },
      {
        name: 'é«˜çº§åŠŸèƒ½',
        icon: 'ğŸš€',
        color: '#8E44AD',
        demos: [
          {
            icon: 'ğŸ¨',
            title: 'ç”»å¸ƒç»˜åˆ¶',
            description: 'Canvas 2D',
            route: 'pages/CanvasDemo',
            color: '#8E44AD'
          },
          {
            icon: 'ğŸ”—',
            title: 'è·¯ç”±å­¦ä¹ ',
            description: 'é¡µé¢è·³è½¬/ç”Ÿå‘½å‘¨æœŸ',
            route: 'pages/RouterDemo',
            color: '#FAAD14'
          }
        ]
      },
      {
        name: 'Kitå­¦ä¹ ',
        icon: 'ğŸ“¦',
        color: '#6F42C1',
        demos: [
          {
            icon: 'ğŸ“¦',
            title: 'Kitå­¦ä¹ ',
            description: 'Network/Image',
            route: 'pages/KitLearningPage',
            color: '#6F42C1'
          }
        ]
      }
    ]
  }

  build() {
    Scroll() {
      Column({ space: 12 }) {
        // é¡¶éƒ¨æ ‡é¢˜
        this.Header()

        // æ‰‹é£ç´åˆ†ç±»åˆ—è¡¨
        Column({ space: 12 }) {
          ForEach(this.categories, (category: CategoryItem, index: number) => {
            this.CategoryCard(category, index)
          }, (category: CategoryItem, index: number) => index.toString())
        }
        .width('100%')
      }
      .width('100%')
      .padding({ left: 16, right: 16, top: 20, bottom: 20 })
    }
    .width('100%')
    .height('100%')
    .backgroundColor('#F5F5F5')
  }

  @Builder
  Header() {
    Column({ space: 8 }) {
      Text('HarmonyOS Demo')
        .fontSize(32)
        .fontWeight(FontWeight.Bold)
        .fontColor('#1F1F1F')

      Text('ArkTS ç»„ä»¶å­¦ä¹ æ¼”ç¤º')
        .fontSize(14)
        .fontColor('#666')
    }
    .width('100%')
    .padding(20)
    .backgroundColor('#FFF7E6')
    .borderRadius(12)
  }

  @Builder
  CategoryCard(category: CategoryItem, index: number) {
    Column({ space: 0 }) {
      // åˆ†ç±»æ ‡é¢˜æ 
      Row() {
        Text(category.icon)
          .fontSize(24)

        Text(category.name)
          .fontSize(18)
          .fontWeight(FontWeight.Medium)
          .fontColor('#1F1F1F')
          .margin({ left: 12 })
          .layoutWeight(1)

        Text(this.expandedIndex === index ? 'â–¼' : 'â–¶')
          .fontSize(14)
          .fontColor('#999')
      }
      .width('100%')
      .height(56)
      .padding({ left: 16, right: 16 })
      .backgroundColor(category.color)
      .borderRadius(12)
      .onClick(() => {
        if (this.expandedIndex === index) {
          this.expandedIndex = -1
        } else {
          this.expandedIndex = index
        }
      })

      // å±•å¼€çš„Demoåˆ—è¡¨
      if (this.expandedIndex === index) {
        Column({ space: 8 }) {
          ForEach(category.demos, (demo: DemoItem) => {
            this.DemoItemRow(demo)
          }, (demo: DemoItem) => demo.route)
        }
        .width('100%')
        .padding(12)
        .backgroundColor(Color.White)
        .borderRadius({ bottomLeft: 12, bottomRight: 12 })
        .margin({ top: 4 })
        .shadow({ radius: 4, color: '#1F000000', offsetX: 0, offsetY: 2 })
      }
    }
    .width('100%')
  }

  @Builder
  DemoItemRow(demo: DemoItem) {
    Row() {
      Text(demo.icon)
        .fontSize(28)

      Column({ space: 4 }) {
        Text(demo.title)
          .fontSize(16)
          .fontWeight(FontWeight.Medium)
          .fontColor('#1F1F1F')

        Text(demo.description)
          .fontSize(12)
          .fontColor('#999')
      }
      .alignItems(HorizontalAlign.Start)
      .margin({ left: 12 })
      .layoutWeight(1)

      Text('â†’')
        .fontSize(20)
        .fontColor(demo.color)
    }
    .width('100%')
    .height(64)
    .padding({ left: 12, right: 12 })
    .backgroundColor('#F8F8F8')
    .borderRadius(8)
    .onClick(() => {
      router.pushUrl({
        url: demo.route
      })
    })
  }
}

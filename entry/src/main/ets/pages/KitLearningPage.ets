import router from '@ohos.router'

/**
 * Kit å­¦ä¹ å¯¼èˆªé¡µé¢
 * é›†ä¸­ç®¡ç†å„ä¸ª Kit çš„å­¦ä¹  Demo
 */

interface KitItem {
  id: string
  name: string
  icon: string
  description: string
  status: 'done' | 'learning' | 'todo'
  route: string
}

@Entry
@Component
struct KitLearningPage {
  @State kits: Array<KitItem> = []

  aboutToAppear() {
    this.kits = [
      {
        id: '1',
        name: 'Network Kit',
        icon: 'ğŸŒ',
        description: 'HTTP ç½‘ç»œè¯·æ±‚ã€æ•°æ®è·å–',
        status: 'done',
        route: 'pages/NetworkKitDemo'
      },
      {
        id: '2',
        name: 'Image Kit',
        icon: 'ğŸ–¼ï¸',
        description: 'å›¾ç‰‡åŠ è½½ã€ç¼“å­˜ã€å ä½å›¾',
        status: 'done',
        route: 'pages/ImageKitDemo'
      },
      {
        id: '3',
        name: 'Preferences Kit',
        icon: 'ğŸ’¾',
        description: 'è½»é‡çº§æ•°æ®å­˜å‚¨',
        status: 'learning',
        route: 'pages/PreferencesKitDemo'
      },
      {
        id: '4',
        name: 'Notification Kit',
        icon: 'ğŸ””',
        description: 'é€šçŸ¥æ¨é€',
        status: 'todo',
        route: 'pages/NotificationKitDemo'
      },
      {
        id: '5',
        name: 'Location Kit',
        icon: 'ğŸ“',
        description: 'åœ°ç†å®šä½æœåŠ¡',
        status: 'todo',
        route: 'pages/LocationKitDemo'
      },
      {
        id: '6',
        name: 'Audio Kit',
        icon: 'ğŸµ',
        description: 'éŸ³é¢‘æ’­æ”¾ã€å½•åˆ¶',
        status: 'todo',
        route: 'pages/AudioKitDemo'
      }
    ]
  }

  build() {
    Scroll() {
      Column({ space: 20 }) {
        // é¡¶éƒ¨å¯¼èˆª
        Row() {
          Button('â† è¿”å›é¦–é¡µ')
            .fontSize(14)
            .onClick(() => {
              router.pushUrl({
                url: 'pages/Index'
              })
            })
        }
        .width('100%')
        .padding({ left: 16, right: 16, top: 10 })

        // æ ‡é¢˜
        Column({ space: 8 }) {
          Text('HarmonyOS Kit å­¦ä¹ ')
            .fontSize(28)
            .fontWeight(FontWeight.Bold)

          Text('ç³»ç»Ÿå­¦ä¹ å„ä¸ª Kit æ¨¡å—çš„ä½¿ç”¨æ–¹æ³•')
            .fontSize(14)
            .fontColor('#666')
        }
        .width('100%')
        .padding({ left: 16, right: 16, bottom: 20 })
        .backgroundColor('#FFFBE6')
        .borderRadius(12)

        // è¿›åº¦ç»Ÿè®¡
        Row({ space: 16 }) {
          Column({ space: 4 }) {
            Text('å·²å­¦ä¹ ')
              .fontSize(12)
              .fontColor('#666')

            Text(`${this.getCompletedCount()}/${this.kits.length}`)
              .fontSize(24)
              .fontWeight(FontWeight.Bold)
              .fontColor('#52C41A')
          }

          Column({ space: 4 }) {
            Text('è¿›è¡Œä¸­')
              .fontSize(12)
              .fontColor('#666')

            Text(`${this.getLearningCount()}/${this.kits.length}`)
              .fontSize(24)
              .fontWeight(FontWeight.Bold)
              .fontColor('#FAAD14')
          }
        }
        .width('100%')
        .justifyContent(FlexAlign.Center)
        .padding(20)
        .backgroundColor(Color.White)
        .borderRadius(12)

        // Kit åˆ—è¡¨
        List({ space: 12 }) {
          ForEach(this.kits, (kit: KitItem) => {
            ListItem() {
              this.KitCard(kit)
            }
          }, (kit: KitItem) => kit.id)
        }
        .width('100%')
        .padding({ left: 16, right: 16 })

        // åº•éƒ¨æç¤º
        Column({ space: 8 }) {
          Text('ğŸ’¡ å­¦ä¹ å»ºè®®')
            .fontSize(14)
            .fontWeight(FontWeight.Medium)
            .width('100%')

          Text('æŒ‰ç…§ Network Kit â†’ Image Kit â†’ Preferences Kit â†’ Notification Kit çš„é¡ºåºå­¦ä¹ ')
            .fontSize(12)
            .fontColor('#666')
            .width('100%')

          Text('æ¯ä¸ª Kit éƒ½æ˜¯å®é™…å¼€å‘ä¸­å¸¸ç”¨çš„åŠŸèƒ½æ¨¡å—')
            .fontSize(12)
            .fontColor('#999')
            .width('100%')
        }
        .width('100%')
        .padding({ left: 16, right: 16, bottom: 20 })
        .backgroundColor('#FFF7E6')
        .borderRadius(12)
      }
      .width('100%')
      .padding({ left: 16, right: 16, top: 20, bottom: 20 })
    }
    .width('100%')
    .height('100%')
    .backgroundColor('#F5F5F5')
  }

  @Builder
  KitCard(kit: KitItem) {
    Row() {
      // å›¾æ ‡
      Text(kit.icon)
        .fontSize(48)

      // ä¸­é—´ä¿¡æ¯
      Column({ space: 6 }) {
        Text(kit.name)
          .fontSize(18)
          .fontWeight(FontWeight.Bold)
          .fontColor('#333')

        Text(kit.description)
          .fontSize(13)
          .fontColor('#999')
      }
      .alignItems(HorizontalAlign.Start)
      .layoutWeight(1)
      .margin({ left: 12 })

      // çŠ¶æ€å¾½ç« 
      this.StatusBadge(kit.status)
    }
    .width('100%')
    .padding(16)
    .backgroundColor(kit.status === 'todo' ? '#F5F5F5' : Color.White)
    .borderRadius(12)
    .border({ width: kit.status === 'todo' ? 0 : 1, color: '#E6E6E6' })
    .shadow({ radius: 8, color: '#10000000', offsetX: 0, offsetY: 2 })
    .onClick(() => {
      if (kit.status !== 'todo') {
        router.pushUrl({
          url: kit.route
        })
      }
    })
  }

  @Builder
  StatusBadge(status: string) {
    if (status === 'done') {
      Text('âœ“ å·²å®Œæˆ')
        .fontSize(11)
        .fontColor('#52C41A')
        .padding({ left: 8, right: 8, top: 2, bottom: 2 })
        .backgroundColor('#F6FFED')
        .borderRadius(4)
    } else if (status === 'learning') {
      Text('â³ å­¦ä¹ ä¸­')
        .fontSize(11)
        .fontColor('#FAAD14')
        .padding({ left: 8, right: 8, top: 2, bottom: 2 })
        .backgroundColor('#FFF7E6')
        .borderRadius(4)
    } else {
      Text('ğŸ”’ å³å°†å¼€æ”¾')
        .fontSize(11)
        .fontColor('#999')
        .padding({ left: 8, right: 8, top: 2, bottom: 2 })
        .backgroundColor('#F5F5F5')
        .borderRadius(4)
    }
  }

  private getCompletedCount(): number {
    return this.kits.filter((kit: KitItem) => kit.status === 'done').length
  }

  private getLearningCount(): number {
    return this.kits.filter((kit: KitItem) => kit.status === 'learning').length
  }
}
